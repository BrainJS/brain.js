{"version":3,"sources":["../../../src/recurrent/matrix/softmax.js"],"names":["softmax","m","result","rows","columns","maxVal","i","weights","length","s","Math","exp"],"mappings":";;;;;kBAOwBA,O;;AAPxB;;;;;;AAEA;;;;;AAKe,SAASA,OAAT,CAAiBC,CAAjB,EAAoB;AACjC,MAAIC,SAAS,eAAWD,EAAEE,IAAb,EAAmBF,EAAEG,OAArB,CAAb,CADiC,CACW;AAC5C,MAAIC,SAAS,CAAC,MAAd;AACA,OAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIL,EAAEM,OAAF,CAAUC,MAA9B,EAAsCF,GAAtC,EAA2C;AACzC,QAAGL,EAAEM,OAAF,CAAUD,CAAV,IAAeD,MAAlB,EAA0B;AACxBA,eAASJ,EAAEM,OAAF,CAAUD,CAAV,CAAT;AACD;AACF;;AAED,MAAIG,IAAI,CAAR;AACA,OAAK,IAAIH,KAAI,CAAb,EAAgBA,KAAIL,EAAEM,OAAF,CAAUC,MAA9B,EAAsCF,IAAtC,EAA2C;AACzCJ,WAAOK,OAAP,CAAeD,EAAf,IAAoBI,KAAKC,GAAL,CAASV,EAAEM,OAAF,CAAUD,EAAV,IAAeD,MAAxB,CAApB;AACAI,SAAKP,OAAOK,OAAP,CAAeD,EAAf,CAAL;AACD;;AAED,OAAK,IAAIA,MAAI,CAAb,EAAgBA,MAAIL,EAAEM,OAAF,CAAUC,MAA9B,EAAsCF,KAAtC,EAA2C;AACzCJ,WAAOK,OAAP,CAAeD,GAAf,KAAqBG,CAArB;AACD;;AAED;AACA;AACA;AACA,SAAOP,MAAP;AACD","file":"softmax.js","sourcesContent":["import Matrix from './';\r\n\r\n/**\r\n *\r\n * @param {Matrix} m\r\n * @returns {Matrix}\r\n */\r\nexport default function softmax(m) {\r\n  let result = new Matrix(m.rows, m.columns); // probability volume\r\n  let maxVal = -999999;\r\n  for (let i = 0; i < m.weights.length; i++) {\r\n    if(m.weights[i] > maxVal) {\r\n      maxVal = m.weights[i];\r\n    }\r\n  }\r\n\r\n  let s = 0;\r\n  for (let i = 0; i < m.weights.length; i++) {\r\n    result.weights[i] = Math.exp(m.weights[i] - maxVal);\r\n    s += result.weights[i];\r\n  }\r\n\r\n  for (let i = 0; i < m.weights.length; i++) {\r\n    result.weights[i] /= s;\r\n  }\r\n\r\n  // no backward pass here needed\r\n  // since we will use the computed probabilities outside\r\n  // to set gradients directly on m\r\n  return result;\r\n}\r\n"]}